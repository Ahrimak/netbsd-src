<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
  	$NetBSD: timed.8,v 1.12 2004/09/28 16:37:08 wiz Exp $
  
   Copyright (c) 1980, 1991 Regents of the University of California.
   All rights reserved.
  
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:
   1. Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
   3. Neither the name of the University nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.
  
   THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
   ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
   ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
   FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
   OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
   HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
   LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
   OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
   SUCH DAMAGE.
  
       @(#)timed.8	8.1 (Berkeley) 6/6/93
   -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>TIMED(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">TIMED(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">TIMED(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<code class="Nm">timed</code> &#x2014;
<div class="Nd">time server daemon</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">timed</code></td>
    <td>[<code class="Fl">-dMt</code>] [<code class="Fl">-F</code>
      <var class="Ar">host ...</var>] [<code class="Fl">-G</code>
      <var class="Ar">netgroup</var>] [<code class="Fl">-i</code>
      <var class="Ar">network</var> | <code class="Fl">-n</code>
      <var class="Ar">network</var>]</td>
  </tr>
</table>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <code class="Nm">timed</code> utility is a time server daemon which is
  normally invoked at boot time from the
  <a class="Xr" href="../html8/rc.html">rc(8)</a> file. It synchronizes the
  host's time with the time of other machines, which are also running
  <code class="Nm">timed</code>, in a local area network. These time servers
  will slow down the clocks of some machines and speed up the clocks of others
  to bring them to the average network time. The average network time is
  computed from measurements of clock differences using the ICMP timestamp
  request message.
<p class="Pp">The following options are available:</p>
<dl class="Bl-tag">
  <dt><a class="permalink" href="#d"><code class="Fl" id="d">-d</code></a></dt>
  <dd>Enable debugging mode; do not detach from the terminal.</dd>
  <dt><a class="permalink" href="#F"><code class="Fl" id="F">-F</code></a>
    <var class="Ar">host ...</var></dt>
  <dd>Create a list of trusted hosts. The <code class="Nm">timed</code> utility
      will only accept trusted hosts as masters. If it finds an untrusted host
      claiming to be master, <code class="Nm">timed</code> will suppress
      incoming messages from that host and call for a new election. This option
      implies the <code class="Fl">-M</code> option. If this option is not
      specified, all hosts on the connected networks are treated as
    trustworthy.</dd>
  <dt><a class="permalink" href="#G"><code class="Fl" id="G">-G</code></a>
    <var class="Ar">netgroup</var></dt>
  <dd>Specify a netgroup of trustworthy hosts, in addition to any masters
      specified with the <code class="Fl">-M</code> flag. This option may only
      be specified once.</dd>
  <dt><a class="permalink" href="#i"><code class="Fl" id="i">-i</code></a>
    <var class="Ar">network</var></dt>
  <dd>Add <var class="Ar">network</var> to the list of networks to ignore. All
      other networks to which the machine is directly connected are used by
      <code class="Nm">timed</code>. This option may be specified multiple times
      to add more than one network to the list.</dd>
  <dt><a class="permalink" href="#M"><code class="Fl" id="M">-M</code></a></dt>
  <dd>Allow this host to become a <code class="Nm">timed</code> master if
      necessary.</dd>
  <dt><a class="permalink" href="#n"><code class="Fl" id="n">-n</code></a>
    <var class="Ar">network</var></dt>
  <dd>Add <var class="Ar">network</var> to the list of allowed networks. All
      other networks to which the machine is directly connected are ignored by
      <code class="Nm">timed</code>. This option may be specified multiple times
      to add more than one network to the list.</dd>
  <dt><a class="permalink" href="#t"><code class="Fl" id="t">-t</code></a></dt>
  <dd>Enable tracing of received messages and log to the file
      <span class="Pa">/var/log/timed.log</span>. Tracing can be turned on or
      off while <code class="Nm">timed</code> is running with the
      <a class="Xr" href="../html8/timedc.html">timedc(8)</a> utility.</dd>
</dl>
<p class="Pp">The <code class="Fl">-n</code> and <code class="Fl">-i</code>
    flags are mutually exclusive and require as arguments real networks to which
    the host is connected (see
    <a class="Xr" href="../html5/networks.html">networks(5)</a>). If neither
    flag is specified, <code class="Nm">timed</code> will listen on all
    connected networks.</p>
<p class="Pp">A <code class="Nm">timed</code> running without the
    <code class="Fl">-M</code> nor <code class="Fl">-F</code> flags will always
    remain a slave. If the <code class="Fl">-F</code> flag is not used,
    <code class="Nm">timed</code> will treat all machines as trustworthy.</p>
<p class="Pp">The <code class="Nm">timed</code> utility is based on a
    master-slave scheme. When <code class="Nm">timed</code> is started on a
    machine, it asks the master for the network time and sets the host's clock
    to that time. After that, it accepts synchronization messages periodically
    sent by the master and calls
    <a class="Xr" href="../html2/adjtime.html">adjtime(2)</a> to perform the
    needed corrections on the host's clock.</p>
<p class="Pp">It also communicates with
    <a class="Xr" href="../html1/date.html">date(1)</a> in order to set the date
    globally, and with <a class="Xr" href="../html8/timedc.html">timedc(8)</a>,
    a <code class="Nm">timed</code> control utility. If the machine running the
    master becomes unreachable, the slaves will elect a new master from among
    those slaves which are running with at least one of the
    <code class="Fl">-M</code> and <code class="Fl">-F</code> flags.</p>
<p class="Pp">At startup <code class="Nm">timed</code> normally checks for a
    master time server on each network to which it is connected, except as
    modified by the <code class="Fl">-n</code> and <code class="Fl">-i</code>
    options described above. It will request synchronization service from the
    first master server located. If permitted by the <code class="Fl">-M</code>
    or <code class="Fl">-F</code> flags, it will provide synchronization service
    on any attached networks on which no trusted master server was detected.
    Such a server propagates the time computed by the top-level master. The
    <code class="Nm">timed</code> utility will periodically check for the
    presence of a master on those networks for which it is operating as a slave.
    If it finds that there are no trusted masters on a network, it will begin
    the election process on that network.</p>
<p class="Pp">One way to synchronize a group of machines is to use
    <a class="Xr" href="../html8/ntpd.html">ntpd(8)</a> to synchronize the clock
    of one machine to a distant standard or a radio receiver and
    <code class="Fl">-F</code> <var class="Ar">hostname</var> to tell its
    <code class="Nm">timed</code> to trust only itself.</p>
<p class="Pp">Messages printed by the kernel on the system console occur with
    interrupts disabled. This means that the clock stops while they are
    printing. A machine with many disk or network hardware problems and
    consequent messages cannot keep good time by itself. Each message typically
    causes the clock to lose a dozen milliseconds. A time daemon can correct the
    result.</p>
<p class="Pp">Messages in the system log about machines that failed to respond
    usually indicate machines that crashed or were turned off. Complaints about
    machines that failed to respond to initial time settings are often
    associated with &#x201C;multi-homed&#x201D; machines that looked for time
    masters on more than one network and eventually chose to become a slave on
    the other network.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="WARNINGS"><a class="permalink" href="#WARNINGS">WARNINGS</a></h1>
Temporal chaos will result if two or more time daemons attempt to adjust the
  same clock. If both <code class="Nm">timed</code> and another time daemon are
  run on the same machine, ensure that the <code class="Fl">-F</code> flag is
  used, so that <code class="Nm">timed</code> never attempts to adjust the local
  clock.
<p class="Pp">The protocol is based on UDP/IP broadcasts. All machines within
    the range of a broadcast that are using the TSP protocol must cooperate.
    There cannot be more than a single administrative domain using the
    <code class="Fl">-F</code> flag among all machines reached by a broadcast
    packet. Failure to follow this rule is usually indicated by complaints
    concerning &#x201C;untrusted&#x201D; machines in the system log.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag Bl-compact">
  <dt><span class="Pa">/var/log/timed.log</span></dt>
  <dd>tracing file for <code class="Nm">timed</code></dd>
  <dt><span class="Pa">/var/log/timed.masterlog</span></dt>
  <dd>log file for master <code class="Nm">timed</code></dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr" href="../html1/date.html">date(1)</a>,
  <a class="Xr" href="../html2/adjtime.html">adjtime(2)</a>,
  <a class="Xr" href="../html2/gettimeofday.html">gettimeofday(2)</a>,
  <a class="Xr" href="../html4/icmp.html">icmp(4)</a>,
  <a class="Xr" href="../html5/netgroup.html">netgroup(5)</a>,
  <a class="Xr" href="../html5/networks.html">networks(5)</a>,
  <a class="Xr" href="../html8/ntpd.html">ntpd(8)</a>,
  <a class="Xr" href="../html8/timedc.html">timedc(8)</a>
<p class="Pp"><cite class="Rs"><span class="RsA">R. Gusella</span> and
    <span class="RsA">S. Zatti</span>, <span class="RsT">TSP: The Time
    Synchronization Protocol for UNIX 4.3BSD</span>.</cite></p>
</section>
<section class="Sh">
<h1 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h1>
The <code class="Nm">timed</code> utility appeared in
  <span class="Ux">4.3BSD</span>.
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">May 11, 1993</td>
    <td class="foot-os">NetBSD 10.99</td>
  </tr>
</table>
</body>
</html>
