<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
  	$NetBSD: fwctl.8,v 1.17 2014/03/18 18:20:46 riastradh Exp $
  
   Copyright (c) 2005 KIYOHARA Takashi
   All rights reserved.
  
   Copyright (c) 2002 Hidetoshi Shimokawa
   All rights reserved.
  
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:
   1. Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
  
   THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
   IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
   WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
   DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,
   INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
   (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
   SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
   HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
   STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
   ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE.
  
   $FreeBSD: src/usr.sbin/fwcontrol/fwcontrol.8,v 1.21 2007/10/31 05:59:17 brueffer Exp $
   -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>FWCTL(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">FWCTL(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">FWCTL(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<code class="Nm">fwctl</code> &#x2014;
<div class="Nd">IEEE1394 control utility</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">fwctl</code></td>
    <td>[<code class="Fl">-prt</code>] [<code class="Fl">-b</code>
      <var class="Ar">pri_req</var>] [<code class="Fl">-c</code>
      <var class="Ar">node</var>] [<code class="Fl">-d</code>
      <var class="Ar">node</var>] [<code class="Fl">-g</code>
      <var class="Ar">gap_count</var>] [<code class="Fl">-l</code>
      <var class="Ar">file</var>] [<code class="Fl">-M</code>
      <var class="Ar">mode</var>] [<code class="Fl">-m</code>
      <var class="Ar">EUI64</var> | <var class="Ar">hostname</var>]
      [<code class="Fl">-o</code> <var class="Ar">node</var>]
      [<code class="Fl">-R</code> <var class="Ar">filename</var>]
      [<code class="Fl">-S</code> <var class="Ar">filename</var>]
      [<code class="Fl">-s</code> <var class="Ar">node</var>]
      [<code class="Fl">-u</code> <var class="Ar">bus_num</var>]</td>
  </tr>
</table>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <code class="Nm">fwctl</code> utility is designed to provide a way for users
  to access and control the <span class="Ux">NetBSD</span> IEEE1394 subsystem.
  Without options, <code class="Nm">fwctl</code> will output a list of devices
  that are/were connected to the bus.
<p class="Pp">The following options are available:</p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><a class="permalink" href="#b"><code class="Fl" id="b">-b</code></a>
    <var class="Ar">pri_req</var></dt>
  <dd>Set the <code class="Dv">PRIORITY_BUDGET</code> register on all supported
      nodes.</dd>
  <dt><a class="permalink" href="#c"><code class="Fl" id="c">-c</code></a>
    <var class="Ar">node</var></dt>
  <dd>Show the configuration ROM on the node.</dd>
  <dt><a class="permalink" href="#d"><code class="Fl" id="d">-d</code></a>
    <var class="Ar">node</var></dt>
  <dd>Hex dump of the configuration ROM.</dd>
  <dt><a class="permalink" href="#f"><code class="Fl" id="f">-f</code></a>
    <var class="Ar">node</var></dt>
  <dd>Force specified <var class="Ar">node</var> to be the root node on the next
      bus reset by sending a PHY config packet. Valid values are 0 - 63.</dd>
  <dt><a class="permalink" href="#g"><code class="Fl" id="g">-g</code></a>
    <var class="Ar">gap_count</var></dt>
  <dd>Broadcast new <var class="Ar">gap_count</var> by phy_config packet. By
      default this value is 63 on all nodes. Valid values are 0 - 63.</dd>
  <dt><a class="permalink" href="#i"><code class="Fl" id="i">-i</code></a>
    <var class="Ar">pri_req</var></dt>
  <dd>Set the <code class="Dv">PRIORITY_BUDGET</code> register on all supported
      nodes.</dd>
  <dt><a class="permalink" href="#l"><code class="Fl" id="l">-l</code></a>
    <var class="Ar">file</var></dt>
  <dd>Load hex dump file of the configuration ROM and parse it.</dd>
  <dt><a class="permalink" href="#M"><code class="Fl" id="M">-M</code></a>
    <var class="Ar">mode</var></dt>
  <dd>Explicitly specify either <var class="Ar">dv</var> or
      <var class="Ar">mpeg</var> mode for the incoming stream. Only meaningful
      in case of and must precede the <code class="Fl">-R</code> option. If not
      specified, the program will try to guess. In case of &#x201C;format
      0x20&#x201D; error, try to force the <var class="Ar">mpeg</var> mode.</dd>
  <dt><a class="permalink" href="#m"><code class="Fl" id="m">-m</code></a>
    <var class="Ar">EUI64</var> | <var class="Ar">hostname</var></dt>
  <dd>Set default fwmem target. Hostname will be converted to EUI64.</dd>
  <dt><a class="permalink" href="#o"><code class="Fl" id="o">-o</code></a>
    <var class="Ar">node</var></dt>
  <dd>Send a link-on PHY packet to the node.</dd>
  <dt><a class="permalink" href="#p"><code class="Fl" id="p">-p</code></a></dt>
  <dd>Dump PHY registers.</dd>
  <dt><a class="permalink" href="#R"><code class="Fl" id="R">-R</code></a>
    <var class="Ar">filename</var></dt>
  <dd>Receive DV or MPEG TS stream and dump it to a file. Use Ctrl-C to stop
      receiving. Some DV cameras seem not to send the stream if a bus manager
      exits. If you cannot get the stream, try the following commands:
    <div class="Bd Pp Bd-indent">
    <pre>
sysctl hw.ieee1394if.try_bmr=0
fwctl -r
    </pre>
    </div>
    <p class="Pp">The resulting file contains raw DV data excluding isochronous
        header and CIP header. It can be handled by the
        <span class="Pa">pkgsrc/multimedia/libdv</span> package. The resulting
        MPEG TS stream can be played and sent over a network using the VideoLAN
        tool (<span class="Pa">pkgsrc/multimedia/vlc</span>). The stream can be
        piped directly to <code class="Nm">vlc</code>, see
        <a class="Sx" href="#EXAMPLES">EXAMPLES</a>.</p>
  </dd>
  <dt><a class="permalink" href="#r"><code class="Fl" id="r">-r</code></a></dt>
  <dd>Initiate bus reset.</dd>
  <dt><a class="permalink" href="#S"><code class="Fl" id="S">-S</code></a>
    <var class="Ar">filename</var></dt>
  <dd>Send a DV file as isochronous stream.</dd>
  <dt><a class="permalink" href="#s"><code class="Fl" id="s">-s</code></a>
    <var class="Ar">node</var></dt>
  <dd>Write to the <code class="Dv">RESET_START</code> register on the
    node.</dd>
  <dt><a class="permalink" href="#t"><code class="Fl" id="t">-t</code></a></dt>
  <dd>Show the topology map.</dd>
  <dt><a class="permalink" href="#u"><code class="Fl" id="u">-u</code></a>
    <var class="Ar">bus_num</var></dt>
  <dd>Specify the IEEE1394 bus number to be operated on. The default is bus
    0.</dd>
</dl>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt><span class="Pa">/dev/fw0.0</span></dt>
  <dd style="width: auto;">&#x00A0;</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
Each DV frame has a fixed size and it is easy to edit the frame order.
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">fwctl -R original.dv</code></div>
<p class="Pp">Receive a DV stream with DV camera attached.</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">dd if=original.dv of=first.dv
  bs=120000 count=30</code></div>
<p class="Pp">Get first 30 frames (NTSC).</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">dd if=original.dv of=second.dv
  bs=120000 skip=30 count=30</code></div>
<p class="Pp">Get second 30 frames (NTSC).</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">cat second.dv first.dv | fwctl -S
  /dev/stdin</code></div>
<p class="Pp">Swap first and second 30 frames and send them to DV recorder.</p>
<p class="Pp">For PAL, replace &#x201C;<code class="Li">bs=120000</code>&#x201D;
    with &#x201C;<code class="Li">bs=144000</code>&#x201D;.</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">fwctl -R file.m2t</code></div>
<p class="Pp">Receive an MPEG TS stream from a camera producing MPEG transport
    stream. This has been tested with SONY HDR-FX1E camera that produces HD
    MPEG-2 stream at 25 Mbps bandwidth.</p>
<p class="Pp">To send the stream from the camera over the network using TCP
    (which surprisingly works better with vlc), you can use</p>
<div class="Bd Bd-indent"><code class="Li">fwctl -R - | nc 192.168.10.11
  9000</code></div>
with <span class="Pa">pkgsrc/net/netcat</span> and to receive the stream, use
<div class="Bd Bd-indent"><code class="Li">nc -l -p 9000 | vlc -</code></div>
<p class="Pp">To netcast via UDP, you need to use
    <span class="Pa">pkgsrc/misc/buffer</span>, since vlc is not fast enough to
    read UDP packets from buffers and thus it experiences dropouts when run
    directly. The sending side can use</p>
<div class="Bd Bd-indent"><code class="Li">fwctl -R - | nc 192.168.10.11
  9000</code></div>
and to receive the stream, use
<div class="Bd Bd-indent"><code class="Li">nc -l -u -p 9000 | buffer -s 10k -b
  1000 -m 20m -p 5 | vlc -</code></div>
<p class="Pp">For more information on how to work with
    <code class="Nm">vlc</code> see its documentation.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr" href="../html1/mplayer.html">mplayer(1)</a>,
  <a class="Xr" href="../html1/vlc.html">vlc(1)</a>,
  <a class="Xr" href="../html4/fwip.html">fwip(4)</a>,
  <a class="Xr" href="../html4/fwohci.html">fwohci(4)</a>,
  <a class="Xr" href="../html4/ieee1394if.html">ieee1394if(4)</a>,
  <a class="Xr" href="../html4/sbp.html">sbp(4)</a>
</section>
<section class="Sh">
<h1 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h1>
The <code class="Nm">fwctl</code> command first appeared in
  <span class="Ux">FreeBSD 5.0</span>, as <code class="Ic">fwcontrol</code>. It
  was added to <span class="Ux">NetBSD 4.0</span> under its present name.
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<span class="An">Hidetoshi Shimokawa</span>
  &lt;<a class="Mt" href="mailto:simokawa@FreeBSD.org">simokawa@FreeBSD.org</a>&gt;
<br/>
<span class="An">Petr Holub</span>
  &lt;<a class="Mt" href="mailto:hopet@ics.muni.cz">hopet@ics.muni.cz</a>&gt; -
  MPEG TS mode.
<br/>
<span class="An">KIYOHARA Takashi</span>
  &lt;<a class="Mt" href="mailto:kiyohara@NetBSD.org">kiyohara@NetBSD.org</a>&gt;
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
This utility is still under development and provided for debugging purposes.
  Especially MPEG TS reception support is very rudimental and supports only
  high-bandwidth MPEG-2 streams (fn field in CIP header equals 3).
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">August 24, 2010</td>
    <td class="foot-os">NetBSD 10.99</td>
  </tr>
</table>
</body>
</html>
