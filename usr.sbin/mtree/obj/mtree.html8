<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
  	$NetBSD: mtree.8,v 1.78 2023/12/02 13:26:09 christos Exp $
  
   Copyright (c) 1989, 1990, 1993
  	The Regents of the University of California.  All rights reserved.
  
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:
   1. Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
   3. Neither the name of the University nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.
  
   THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
   ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
   ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
   FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
   OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
   HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
   LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
   OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
   SUCH DAMAGE.
  
   Copyright (c) 2001-2004 The NetBSD Foundation, Inc.
   All rights reserved.
  
   This code is derived from software contributed to The NetBSD Foundation
   by Luke Mewburn of Wasabi Systems.
  
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:
   1. Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
  
   THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
   ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
   TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
   PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
   BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
   INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
   CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE.
  
       @(#)mtree.8	8.2 (Berkeley) 12/11/93
   -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>MTREE(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MTREE(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">MTREE(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<code class="Nm">mtree</code> &#x2014;
<div class="Nd">map a directory hierarchy</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">mtree</code></td>
    <td>[<code class="Fl">-bCcDdejLlMnPqrStUuWx</code>]
      [<code class="Fl">-i</code> | <code class="Fl">-m</code>]
      [<code class="Fl">-E</code> <var class="Ar">tags</var>]
      [<code class="Fl">-F</code> <var class="Ar">flavor</var>]
      [<code class="Fl">-f</code> <var class="Ar">spec</var>]
      [<code class="Fl">-I</code> <var class="Ar">tags</var>]
      [<code class="Fl">-K</code> <var class="Ar">keywords</var>]
      [<code class="Fl">-k</code> <var class="Ar">keywords</var>]
      [<code class="Fl">-N</code> <var class="Ar">dbdir</var>]
      [<code class="Fl">-O</code> <var class="Ar">onlyfile</var>]
      [<code class="Fl">-p</code> <var class="Ar">path</var>]
      [<code class="Fl">-R</code> <var class="Ar">keywords</var>]
      [<code class="Fl">-s</code> <var class="Ar">seed</var>]
      [<code class="Fl">-X</code> <var class="Ar">exclude-file</var>]</td>
  </tr>
</table>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <code class="Nm">mtree</code> utility compares a file hierarchy against a
  specification, creates a specification for a file hierarchy, or modifies a
  specification.
<p class="Pp">The default action, if not overridden by command line options, is
    to compare the file hierarchy rooted in the current directory against a
    specification read from the standard input. Messages are written to the
    standard output for any files whose characteristics do not match the
    specification, or which are missing from either the file hierarchy or the
    specification.</p>
<p class="Pp">The options are as follows:</p>
<dl class="Bl-tag">
  <dt><a class="permalink" href="#b"><code class="Fl" id="b">-b</code></a></dt>
  <dd>Suppress blank lines before entering and after exiting directories.</dd>
  <dt><a class="permalink" href="#C"><code class="Fl" id="C">-C</code></a></dt>
  <dd>Convert a specification into a format that's easier to parse with various
      tools. The input specification is read from standard input or from the
      file given by <code class="Fl">-f</code> <var class="Ar">spec</var>. In
      the output, each file or directory is represented using a single line
      (which might be very long). The full path name (beginning with
      &#x2018;<code class="Li">./</code>&#x2019;) is always printed as the first
      field; <code class="Fl">-K</code>, <code class="Fl">-k</code>, and
      <code class="Fl">-R</code> can be used to control which other keywords are
      printed; <code class="Fl">-E</code> and <code class="Fl">-I</code> can be
      used to control which files are printed; and the
      <code class="Fl">-S</code> option can be used to sort the output.</dd>
  <dt><a class="permalink" href="#c"><code class="Fl" id="c">-c</code></a></dt>
  <dd>Print a specification for the file hierarchy originating at the current
      working directory (or the directory provided by <code class="Fl">-p</code>
      <var class="Ar">path</var>) to the standard output. The output is in a
      style using relative path names.</dd>
  <dt><a class="permalink" href="#D"><code class="Fl" id="D">-D</code></a></dt>
  <dd>As per <code class="Fl">-C</code>, except that the path name is always
      printed as the last field instead of the first.</dd>
  <dt><a class="permalink" href="#d"><code class="Fl" id="d">-d</code></a></dt>
  <dd>Ignore everything except directory type files.</dd>
  <dt><a class="permalink" href="#E"><code class="Fl" id="E">-E</code></a>
    <var class="Ar">tags</var></dt>
  <dd>Add the comma separated tags to the &#x201C;exclusion&#x201D; list.
      Non-directories with tags which are in the exclusion list are not printed
      with <code class="Fl">-C</code> and <code class="Fl">-D</code>.</dd>
  <dt><a class="permalink" href="#e"><code class="Fl" id="e">-e</code></a></dt>
  <dd>Don't complain about files that are in the file hierarchy, but not in the
      specification.</dd>
  <dt><a class="permalink" href="#F"><code class="Fl" id="F">-F</code></a>
    <var class="Ar">flavor</var></dt>
  <dd>Set the compatibility flavor of the <code class="Nm">mtree</code> utility.
      The <var class="Ar">flavor</var> can be one of
      <code class="Cm">mtree</code>, <code class="Cm">freebsd9</code>, or
      <code class="Cm">netbsd6</code>. The default is
      <code class="Cm">mtree</code>. The <code class="Cm">freebsd9</code> and
      <code class="Cm">netbsd6</code> flavors attempt to preserve output
      compatibility and command line option backward compatibility with
      <span class="Ux">FreeBSD 9.0</span> and <span class="Ux">NetBSD 6.0</span>
      respectively.</dd>
  <dt><a class="permalink" href="#f"><code class="Fl" id="f">-f</code></a>
    <var class="Ar">spec</var></dt>
  <dd>Read the specification from <var class="Ar">file</var>, instead of from
      the standard input.
    <p class="Pp">If this option is specified twice, the two specifications are
        compared to each other rather than to the file hierarchy. The
        specifications will be sorted like output generated using
        <code class="Fl">-c</code>. The output format in this case is somewhat
        reminiscent of <a class="Xr" href="../html1/comm.html">comm(1)</a>,
        having &#x201C;in first spec only&#x201D;, &#x201C;in second spec
        only&#x201D;, and &#x201C;different&#x201D; columns, prefixed by zero,
        one and two TAB characters respectively. Each entry in the
        &#x201C;different&#x201D; column occupies two lines, one from each
        specification.</p>
  </dd>
  <dt><a class="permalink" href="#I"><code class="Fl" id="I">-I</code></a>
    <var class="Ar">tags</var></dt>
  <dd>Add the comma separated tags to the &#x201C;inclusion&#x201D; list.
      Non-directories with tags which are in the inclusion list are printed with
      <code class="Fl">-C</code> and <code class="Fl">-D</code>. If no inclusion
      list is provided, the default is to display all files.</dd>
  <dt><a class="permalink" href="#i"><code class="Fl" id="i">-i</code></a></dt>
  <dd>If specified, set the &#x2018;<code class="Li">schg</code>&#x2019; and/or
      &#x2018;<code class="Li">sappnd</code>&#x2019; flags.</dd>
  <dt><a class="permalink" href="#j"><code class="Fl" id="j">-j</code></a></dt>
  <dd>Indent the output 4 spaces each time a directory level is descended when
      creating a specification with the <code class="Fl">-c</code> option. This
      does not affect either the &#x2018;<code class="Li">/set</code>&#x2019;
      statements or the comment before each directory. It does however affect
      the comment before the close of each directory. This is the equivalent of
      the <code class="Fl">-i</code> option in the
      <span class="Ux">FreeBSD</span> version of
    <code class="Nm">mtree</code>.</dd>
  <dt><a class="permalink" href="#K"><code class="Fl" id="K">-K</code></a>
    <var class="Ar">keywords</var></dt>
  <dd>Add the specified (whitespace or comma separated) keywords to the current
      set of keywords. If &#x2018;<code class="Li">all</code>&#x2019; is
      specified, add all of the other keywords.</dd>
  <dt><a class="permalink" href="#k"><code class="Fl" id="k">-k</code></a>
    <var class="Ar">keywords</var></dt>
  <dd>Use the <b class="Sy">type</b> keyword plus the specified (whitespace or
      comma separated) <var class="Ar">keywords</var> instead of the current set
      of keywords. If &#x2018;<code class="Li">all</code>&#x2019; is specified,
      use all of the other keywords. If the <b class="Sy">type</b> keyword is
      not desired, suppress it with <code class="Fl">-R</code>
      <code class="Cm">type</code>.</dd>
  <dt><a class="permalink" href="#L"><code class="Fl" id="L">-L</code></a></dt>
  <dd>Follow all symbolic links in the file hierarchy.</dd>
  <dt><a class="permalink" href="#l"><code class="Fl" id="l">-l</code></a></dt>
  <dd>Do &#x201C;loose&#x201D; permissions checks, in which more stringent
      permissions will match less stringent ones. For example, a file marked
      mode 0444 will pass a check for mode 0644. &#x201C;Loose&#x201D; checks
      apply only to read, write and execute permissions &#x2014; in particular,
      if other bits like the sticky bit or suid/sgid bits are set either in the
      specification or the file, exact checking will be performed. This option
      may not be set at the same time as the <code class="Fl">-U</code> or
      <code class="Fl">-u</code> option.</dd>
  <dt><a class="permalink" href="#M"><code class="Fl" id="M">-M</code></a></dt>
  <dd>Permit merging of specification entries with different types, with the
      last entry taking precedence.</dd>
  <dt><a class="permalink" href="#m"><code class="Fl" id="m">-m</code></a></dt>
  <dd>If the &#x2018;<code class="Li">schg</code>&#x2019; and/or
      &#x2018;<code class="Li">sappnd</code>&#x2019; flags are specified, reset
      these flags. Note that this is only possible with securelevel less than 1
      (i.e., in single user mode or while the system is running in insecure
      mode). See <a class="Xr" href="../html8/init.html">init(8)</a> for
      information on security levels.</dd>
  <dt><a class="permalink" href="#n"><code class="Fl" id="n">-n</code></a></dt>
  <dd>Do not emit pathname comments when creating a specification. Normally a
      comment is emitted before each directory and before the close of that
      directory when using the <code class="Fl">-c</code> option.</dd>
  <dt><a class="permalink" href="#N"><code class="Fl" id="N">-N</code></a>
    <var class="Ar">dbdir</var></dt>
  <dd>Use the user database text file <span class="Pa">master.passwd</span> and
      group database text file <span class="Pa">group</span> from
      <var class="Ar">dbdir</var>, rather than using the results from the
      system's <a class="Xr" href="../html3/getpwnam.html">getpwnam(3)</a> and
      <a class="Xr" href="../html3/getgrnam.html">getgrnam(3)</a> (and related)
      library calls.</dd>
  <dt><a class="permalink" href="#O"><code class="Fl" id="O">-O</code></a>
    <var class="Ar">onlypaths</var></dt>
  <dd>Only include files included in this list of pathnames.</dd>
  <dt><a class="permalink" href="#P"><code class="Fl" id="P">-P</code></a></dt>
  <dd>Don't follow symbolic links in the file hierarchy, instead consider the
      symbolic link itself in any comparisons. This is the default.</dd>
  <dt><a class="permalink" href="#p"><code class="Fl" id="p">-p</code></a>
    <var class="Ar">path</var></dt>
  <dd>Use the file hierarchy rooted in <var class="Ar">path</var>, instead of
      the current directory.</dd>
  <dt><a class="permalink" href="#q"><code class="Fl" id="q">-q</code></a></dt>
  <dd>Quiet mode. Do not complain when a &#x201C;missing&#x201D; directory
      cannot be created because it already exists. This occurs when the
      directory is a symbolic link.</dd>
  <dt><a class="permalink" href="#R"><code class="Fl" id="R">-R</code></a>
    <var class="Ar">keywords</var></dt>
  <dd>Remove the specified (whitespace or comma separated) keywords from the
      current set of keywords. If &#x2018;<code class="Li">all</code>&#x2019; is
      specified, remove all of the other keywords.</dd>
  <dt><a class="permalink" href="#r"><code class="Fl" id="r">-r</code></a></dt>
  <dd>Remove any files in the file hierarchy that are not described in the
      specification. Repeating the flag more than once will attempt to reset all
      the file flags via
      <a class="Xr" href="../html2/lchflags.html">lchflags(2)</a> before
      attempting to remove the file in case the file was immutable.</dd>
  <dt><a class="permalink" href="#S"><code class="Fl" id="S">-S</code></a></dt>
  <dd>When reading a specification into an internal data structure, sort the
      entries. Sorting will affect the order of the output produced by the
      <code class="Fl">-C</code> or <code class="Fl">-D</code> options, and will
      also affect the order in which missing entries are created or reported
      when a directory tree is checked against a specification.
    <p class="Pp">The sort order is the same as that used by the
        <code class="Fl">-c</code> option, which is that entries within the same
        directory are sorted in the order used by
        <a class="Xr" href="../html3/strcmp.html">strcmp(3)</a>, except that
        entries for subdirectories sort after other entries. By default, if the
        <code class="Fl">-S</code> option is not used, entries within the same
        directory are collected together (separated from entries for other
        directories), but not sorted.</p>
  </dd>
  <dt><a class="permalink" href="#s"><code class="Fl" id="s">-s</code></a>
    <var class="Ar">seed</var></dt>
  <dd>Display a single checksum to the standard error output that represents all
      of the files for which the keyword <b class="Sy">cksum</b> was specified.
      The checksum is seeded with the specified value.</dd>
  <dt><a class="permalink" href="#t"><code class="Fl" id="t">-t</code></a></dt>
  <dd>Modify the modified time of existing files, the device type of devices,
      and symbolic link targets, to match the specification.</dd>
  <dt><a class="permalink" href="#U"><code class="Fl" id="U">-U</code></a></dt>
  <dd>Same as <code class="Fl">-u</code> except that a mismatch is not
      considered to be an error if it was corrected.</dd>
  <dt><a class="permalink" href="#u"><code class="Fl" id="u">-u</code></a></dt>
  <dd>Modify the owner, group, permissions, and flags of existing files, the
      device type of devices, and symbolic link targets, to match the
      specification. Create any missing directories, devices or symbolic links.
      User, group, and permissions must all be specified for missing directories
      to be created. Note that unless the <code class="Fl">-i</code> option is
      given, the schg and sappnd flags will not be set, even if specified. If
      <code class="Fl">-m</code> is given, these flags will be reset. Exit with
      a status of 0 on success, 2 if the file hierarchy did not match the
      specification, and 1 if any other error occurred.</dd>
  <dt><a class="permalink" href="#W"><code class="Fl" id="W">-W</code></a></dt>
  <dd>Don't attempt to set various file attributes such as the ownership, mode,
      flags, or time when creating new directories or changing existing entries.
      This option will be most useful when used in conjunction with
      <code class="Fl">-U</code> or <code class="Fl">-u</code>.</dd>
  <dt><a class="permalink" href="#X"><code class="Fl" id="X">-X</code></a>
    <var class="Ar">exclude-file</var></dt>
  <dd>The specified file contains
      <a class="Xr" href="../html3/fnmatch.html">fnmatch(3)</a> patterns
      matching files to be excluded from the specification, one to a line. If
      the pattern contains a &#x2018;<code class="Li">/</code>&#x2019;
      character, it will be matched against entire pathnames (relative to the
      starting directory); otherwise, it will be matched against basenames only.
      Comments are permitted in the <var class="Ar">exclude-file</var>
    file.</dd>
  <dt><a class="permalink" href="#x"><code class="Fl" id="x">-x</code></a></dt>
  <dd>Don't descend below mount points in the file hierarchy.</dd>
</dl>
<p class="Pp">Specifications are mostly composed of &#x201C;keywords&#x201D;,
    i.e. strings that that specify values relating to files. No keywords have
    default values, and if a keyword has no value set, no checks based on it are
    performed.</p>
<p class="Pp">Currently supported keywords are as follows:</p>
<dl class="Bl-tag">
  <dt><b class="Sy">cksum</b></dt>
  <dd>The checksum of the file using the default algorithm specified by the
      <a class="Xr" href="../html1/cksum.html">cksum(1)</a> utility.</dd>
  <dt><b class="Sy">device</b></dt>
  <dd>The device number to use for <b class="Sy">block</b> or
      <b class="Sy">char</b> file types. The argument must be one of the
      following forms:
    <dl class="Bl-tag">
      <dt><var class="Ar">format</var>,<var class="Ar">major</var>,<var class="Ar">minor</var></dt>
      <dd>A device with <var class="Ar">major</var> and
          <var class="Ar">minor</var> fields, for an operating system specified
          with <var class="Ar">format</var>. See below for valid formats.</dd>
      <dt><var class="Ar">format</var>,<var class="Ar">major</var>,<var class="Ar">unit</var>,<var class="Ar">subunit</var></dt>
      <dd>A device with <var class="Ar">major</var>, <var class="Ar">unit</var>,
          and <var class="Ar">subunit</var> fields, for an operating system
          specified with <var class="Ar">format</var>. (Currently this is only
          supported by the <b class="Sy">bsdos</b> format.)</dd>
      <dt><var class="Ar">number</var></dt>
      <dd>Opaque number (as stored on the file system).</dd>
    </dl>
    <p class="Pp">The following values for <var class="Ar">format</var> are
        recognized: <b class="Sy">native</b>, <b class="Sy">386bsd</b>,
        <b class="Sy">4bsd</b>, <b class="Sy">bsdos</b>,
        <b class="Sy">freebsd</b>, <b class="Sy">hpux</b>,
        <b class="Sy">isc</b>, <b class="Sy">linux</b>,
        <b class="Sy">netbsd</b>, <b class="Sy">osf1</b>, <b class="Sy">sco</b>,
        <b class="Sy">solaris</b>, <b class="Sy">sunos</b>,
        <b class="Sy">svr3</b>, <b class="Sy">svr4</b>, and
        <b class="Sy">ultrix</b>.</p>
    <p class="Pp">See <a class="Xr" href="../html8/mknod.html">mknod(8)</a> for
        more details.</p>
  </dd>
  <dt><b class="Sy">flags</b></dt>
  <dd>The file flags as a symbolic name. See
      <a class="Xr" href="../html1/chflags.html">chflags(1)</a> for information
      on these names. If no flags are to be set the string
      &#x2018;<code class="Li">none</code>&#x2019; may be used to override the
      current default. Note that the schg and sappnd flags are treated specially
      (see the <code class="Fl">-i</code> and <code class="Fl">-m</code>
      options).</dd>
  <dt><b class="Sy">ignore</b></dt>
  <dd>Ignore any file hierarchy below this file.</dd>
  <dt><b class="Sy">gid</b></dt>
  <dd>The file group as a numeric value.</dd>
  <dt><b class="Sy">gname</b></dt>
  <dd>The file group as a symbolic name.</dd>
  <dt><b class="Sy">link</b></dt>
  <dd>The file the symbolic link is expected to reference.</dd>
  <dt><b class="Sy">md5</b></dt>
  <dd>The MD5 cryptographic message digest of the file.</dd>
  <dt><b class="Sy">md5digest</b></dt>
  <dd>Synonym for <b class="Sy">md5</b>.</dd>
  <dt><b class="Sy">mode</b></dt>
  <dd>The current file's permissions as a numeric (octal) or symbolic
    value.</dd>
  <dt><b class="Sy">nlink</b></dt>
  <dd>The number of hard links the file is expected to have.</dd>
  <dt><b class="Sy">nochange</b></dt>
  <dd>Make sure this file or directory exists but otherwise ignore all
      attributes.</dd>
  <dt><b class="Sy">optional</b></dt>
  <dd>The file is optional; don't complain about the file if it's not in the
      file hierarchy.</dd>
  <dt><b class="Sy">ripemd160digest</b></dt>
  <dd>Synonym for <b class="Sy">rmd160</b>.</dd>
  <dt><b class="Sy">rmd160</b></dt>
  <dd>The RMD-160 cryptographic message digest of the file.</dd>
  <dt><b class="Sy">rmd160digest</b></dt>
  <dd>Synonym for <b class="Sy">rmd160</b>.</dd>
  <dt><b class="Sy">sha1</b></dt>
  <dd>The SHA-1 cryptographic message digest of the file.</dd>
  <dt><b class="Sy">sha1digest</b></dt>
  <dd>Synonym for <b class="Sy">sha1</b>.</dd>
  <dt><b class="Sy">sha256</b></dt>
  <dd>The 256-bits SHA-2 cryptographic message digest of the file.</dd>
  <dt><b class="Sy">sha256digest</b></dt>
  <dd>Synonym for <b class="Sy">sha256</b>.</dd>
  <dt><b class="Sy">sha384</b></dt>
  <dd>The 384-bits SHA-2 cryptographic message digest of the file.</dd>
  <dt><b class="Sy">sha384digest</b></dt>
  <dd>Synonym for <b class="Sy">sha384</b>.</dd>
  <dt><b class="Sy">sha512</b></dt>
  <dd>The 512-bits SHA-2 cryptographic message digest of the file.</dd>
  <dt><b class="Sy">sha512digest</b></dt>
  <dd>Synonym for <b class="Sy">sha512</b>.</dd>
  <dt><b class="Sy">size</b></dt>
  <dd>The size, in bytes, of the file.</dd>
  <dt><b class="Sy">tags</b></dt>
  <dd>Comma delimited tags to be matched with <code class="Fl">-E</code> and
      <code class="Fl">-I</code>. These may be specified without leading or
      trailing commas, but will be stored internally with them.</dd>
  <dt><b class="Sy">time</b></dt>
  <dd>The last modification time of the file, in second and nanoseconds. The
      value should include a period character and exactly nine digits after the
      period.</dd>
  <dt><b class="Sy">type</b></dt>
  <dd>The type of the file; may be set to any one of the following:
    <p class="Pp"></p>
    <dl class="Bl-tag Bl-compact">
      <dt><b class="Sy">block</b></dt>
      <dd>block special device</dd>
      <dt><b class="Sy">char</b></dt>
      <dd>character special device</dd>
      <dt><b class="Sy">dir</b></dt>
      <dd>directory</dd>
      <dt><b class="Sy">fifo</b></dt>
      <dd>fifo</dd>
      <dt><b class="Sy">file</b></dt>
      <dd>regular file</dd>
      <dt><b class="Sy">link</b></dt>
      <dd>symbolic link</dd>
      <dt><b class="Sy">socket</b></dt>
      <dd>socket</dd>
    </dl>
  </dd>
  <dt><b class="Sy">uid</b></dt>
  <dd>The file owner as a numeric value.</dd>
  <dt><b class="Sy">uname</b></dt>
  <dd>The file owner as a symbolic name.</dd>
</dl>
<p class="Pp">The default set of keywords are <b class="Sy">flags</b>,
    <b class="Sy">gid</b>, <b class="Sy">link</b>, <b class="Sy">mode</b>,
    <b class="Sy">nlink</b>, <b class="Sy">size</b>, <b class="Sy">time</b>,
    <b class="Sy">type</b>, and <b class="Sy">uid</b>.</p>
<p class="Pp">There are four types of lines in a specification:</p>
<ol class="Bl-enum">
  <li>Set global values for a keyword. This consists of the string
      &#x2018;<code class="Li">/set</code>&#x2019; followed by whitespace,
      followed by sets of keyword/value pairs, separated by whitespace.
      Keyword/value pairs consist of a keyword, followed by an equals sign
      (&#x2018;<code class="Li">=</code>&#x2019;), followed by a value, without
      whitespace characters. Once a keyword has been set, its value remains
      unchanged until either reset or unset.</li>
  <li>Unset global values for a keyword. This consists of the string
      &#x2018;<code class="Li">/unset</code>&#x2019;, followed by whitespace,
      followed by one or more keywords, separated by whitespace. If
      &#x2018;<code class="Li">all</code>&#x2019; is specified, unset all of the
      keywords.</li>
  <li>A file specification, consisting of a path name, followed by whitespace,
      followed by zero or more whitespace separated keyword/value pairs.
    <p class="Pp">The path name may be preceded by whitespace characters. The
        path name may contain any of the standard path name matching characters
        (&#x2018;<code class="Li">[</code>&#x2019;,
        &#x2018;<code class="Li">]</code>&#x2019;,
        &#x2018;<code class="Li">?</code>&#x2019; or
        &#x2018;<code class="Li">*</code>&#x2019;), in which case files in the
        hierarchy will be associated with the first pattern that they match.
        <code class="Nm">mtree</code> uses
        <a class="Xr" href="../html3/strsvis.html">strsvis(3)</a> (in
        <code class="Dv">VIS_OCTAL</code> format) to encode path names
        containing non-printable characters. Whitespace characters are encoded
        as &#x2018;<code class="Li">\040</code>&#x2019; (space),
        &#x2018;<code class="Li">\011</code>&#x2019; (tab), and
        &#x2018;<code class="Li">\012</code>&#x2019; (new line). When flavor
        <b class="Sy">netbsd6</b> is selected,
        <a class="Xr" href="../html3/strsvis.html">strsvis(3)</a> (in
        <code class="Dv">VIS_CSTYLE</code> format) is used and whitespace
        characters are encoded as &#x2018;<code class="Li">\s</code>&#x2019;
        (space), &#x2018;<code class="Li">\t</code>&#x2019; (tab), and
        &#x2018;<code class="Li">\n</code>&#x2019; (new line).
        &#x2018;<code class="Li">#</code>&#x2019; characters in path names are
        escaped by a preceding backslash
        &#x2018;<code class="Li">\</code>&#x2019; to distinguish them from
        comments.</p>
    <p class="Pp">Each of the keyword/value pairs consist of a keyword, followed
        by an equals sign (&#x2018;<code class="Li">=</code>&#x2019;), followed
        by the keyword's value, without whitespace characters. These values
        override, without changing, the global value of the corresponding
        keyword.</p>
    <p class="Pp">The first path name entry listed must be a directory named
        &#x2018;<code class="Li">.</code>&#x2019;, as this ensures that
        intermixing full and relative path names will work consistently and
        correctly. Multiple entries for a directory named
        &#x2018;<code class="Li">.</code>&#x2019; are permitted; the settings
        for the last such entry override those of the existing entry.</p>
    <p class="Pp">A path name that contains a slash
        (&#x2018;<code class="Li">/</code>&#x2019;) that is not the first
        character will be treated as a full path (relative to the root of the
        tree). All parent directories referenced in the path name must exist.
        The current directory path used by relative path names will be updated
        appropriately. Multiple entries for the same full path are permitted if
        the types are the same (unless <code class="Fl">-M</code> is given, in
        which case the types may differ); in this case the settings for the last
        entry take precedence.</p>
    <p class="Pp">A path name that does not contain a slash will be treated as a
        relative path. Specifying a directory will cause subsequent files to be
        searched for in that directory hierarchy.</p>
  </li>
  <li>A line containing only the string
      &#x2018;<code class="Li">..</code>&#x2019; which causes the current
      directory path (used by relative paths) to ascend one level.</li>
</ol>
<p class="Pp">Empty lines and lines whose first non-whitespace character is a
    hash mark (&#x2018;<code class="Li">#</code>&#x2019;) are ignored.</p>
<p class="Pp">The <code class="Nm">mtree</code> utility exits with a status of 0
    on success, 1 if any error occurred, and 2 if the file hierarchy did not
    match the specification.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag Bl-compact">
  <dt><span class="Pa">/etc/mtree</span></dt>
  <dd>system specification directory</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
To detect system binaries that have been &#x201C;trojan horsed&#x201D;, it is
  recommended that <code class="Nm">mtree</code> be run on the file systems, and
  a copy of the results stored on a different machine, or, at least, in
  encrypted form. The seed for the <code class="Fl">-s</code> option should not
  be an obvious value and the final checksum should not be stored on-line under
  any circumstances! Then, periodically, <code class="Nm">mtree</code> should be
  run against the on-line specifications and the final checksum compared with
  the previous value. While it is possible for the bad guys to change the
  on-line specifications to conform to their modified binaries, it shouldn't be
  possible for them to make it produce the same final checksum value. If the
  final checksum value changes, the off-line copies of the specification can be
  used to detect which of the binaries have actually been modified.
<p class="Pp">The <code class="Fl">-d</code> option can be used in combination
    with <code class="Fl">-U</code> or <code class="Fl">-u</code> to create
    directory hierarchies for, for example, distributions.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COMPATIBILITY"><a class="permalink" href="#COMPATIBILITY">COMPATIBILITY</a></h1>
The compatibility shims provided by the <code class="Fl">-F</code> option are
  incomplete by design. Known limitations are described below.
<p class="Pp">The <b class="Sy">freebsd9</b> flavor retains the default handling
    of lookup failures for the <b class="Sy">uname</b> and
    <b class="Sy">group</b> keywords by replacing them with appropriate
    <b class="Sy">uid</b> and <b class="Sy">gid</b> keywords rather than failing
    and reporting an error. The related <code class="Fl">-w</code> flag is a
    no-op rather than causing a warning to be printed and no keyword to be
    emitted. The latter behavior is not emulated as it is potentially dangerous
    in the face of /set statements.</p>
<p class="Pp">The <b class="Sy">netbsd6</b> flavor does not replicate the
    historical bug that reported time as seconds.nanoseconds without zero
    padding nanosecond values less than 100000000.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr" href="../html1/chflags.html">chflags(1)</a>,
  <a class="Xr" href="../html1/chgrp.html">chgrp(1)</a>,
  <a class="Xr" href="../html1/chmod.html">chmod(1)</a>,
  <a class="Xr" href="../html1/cksum.html">cksum(1)</a>,
  <a class="Xr" href="../html2/stat.html">stat(2)</a>,
  <a class="Xr" href="../html3/fnmatch.html">fnmatch(3)</a>,
  <a class="Xr" href="../html3/fts.html">fts(3)</a>,
  <a class="Xr" href="../html3/strsvis.html">strsvis(3)</a>,
  <a class="Xr" href="../html5/mtree.html">mtree(5)</a>,
  <a class="Xr" href="../html8/chown.html">chown(8)</a>,
  <a class="Xr" href="../html8/mknod.html">mknod(8)</a>
</section>
<section class="Sh">
<h1 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h1>
The <code class="Nm">mtree</code> utility appeared in
  <span class="Ux">4.3BSD-Reno</span>. The <b class="Sy">optional</b> keyword
  appeared in <span class="Ux">NetBSD 1.2</span>. The <code class="Fl">-U</code>
  option appeared in <span class="Ux">NetBSD 1.3</span>. The
  <b class="Sy">flags</b> and <b class="Sy">md5</b> keywords, and
  <code class="Fl">-i</code> and <code class="Fl">-m</code> options appeared in
  <span class="Ux">NetBSD 1.4</span>. The <b class="Sy">device</b>,
  <b class="Sy">rmd160</b>, <b class="Sy">sha1</b>, <b class="Sy">tags</b>, and
  <b class="Sy">all</b> keywords, <code class="Fl">-D</code>,
  <code class="Fl">-E</code>, <code class="Fl">-I</code>,
  <code class="Fl">-L</code>, <code class="Fl">-l</code>,
  <code class="Fl">-N</code>, <code class="Fl">-P</code>,
  <code class="Fl">-R</code>, <code class="Fl">-W</code>, and
  <code class="Fl">-X</code> options, and support for full paths appeared in
  <span class="Ux">NetBSD 1.6</span>. The <b class="Sy">sha256</b>,
  <b class="Sy">sha384</b>, and <b class="Sy">sha512</b> keywords appeared in
  <span class="Ux">NetBSD 3.0</span>. The <code class="Fl">-S</code> option
  appeared in <span class="Ux">NetBSD 6.0</span>.
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">December 2, 2023</td>
    <td class="foot-os">NetBSD 10.99</td>
  </tr>
</table>
</body>
</html>
